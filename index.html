<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èª¿é…ä½ çš„å·§å…‹åŠ› - æ­·å²é…æ–¹æ¨¡æ“¬</title>
    <style>
        :root {
            --bg-color: #b3a085;
            --container-bg: #c4b5a2;
            --card-bg: #f9f3e9;
            --primary-text: #4a3427;
            --accent-color: #f7a56d;
            --selected-border: #8b5a2b;
            --border-dark: #7a6a53;
        }

        body {
            background-color: var(--bg-color);
            font-family: "Microsoft JhengHei", "PingFang TC", sans-serif;
            color: var(--primary-text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            background-color: var(--container-bg);
            border: 3px solid var(--border-dark);
            padding: 30px;
            max-width: 500px;
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        h1 { text-align: center; font-size: 2.2rem; margin: 0; letter-spacing: 2px; }
        .subtitle { text-align: center; margin: 5px 0 15px 0; font-size: 0.9rem; opacity: 0.8; }
        hr { border: 0; border-top: 1.5px solid var(--border-dark); margin-bottom: 25px; }

        .section-header { display: flex; align-items: center; margin-bottom: 15px; }
        .orange-bar { width: 6px; height: 24px; background-color: var(--accent-color); margin-right: 10px; }
        .section-title { font-size: 1.3rem; font-weight: bold; margin: 0; }
        .section-title small { font-size: 0.8rem; font-weight: normal; margin-left: 5px; }

        /* é£Ÿæé¸æ“‡å€ */
        .ingredient-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 30px;
        }

        .ingredient-card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 15px 5px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 3px solid transparent;
            user-select: none;
        }

        .ingredient-card:hover { transform: scale(1.03); background-color: #fff; }
        .ingredient-card.active {
            border-color: var(--selected-border);
            box-shadow: 0 0 15px rgba(139, 90, 43, 0.4);
            background-color: #ffffff;
        }

        .icon { font-size: 2.2rem; margin-bottom: 8px; display: block; }
        .ingredient-card p { margin: 0; font-weight: bold; font-size: 0.95rem; }

        /* æ”ªæ‹Œèˆ‡é¡¯ç¤ºå€ */
        .instruction { font-size: 0.85rem; margin-bottom: 10px; }
        .mixer-layout { display: flex; gap: 15px; align-items: stretch; }

        .display-area {
            flex: 1;
            background-color: var(--card-bg);
            border-radius: 15px;
            border: 8px solid #a8947a;
            min-height: 160px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
        }

        .controls { display: flex; flex-direction: column; gap: 10px; }

        .btn-mix {
            background-color: var(--accent-color);
            border: none;
            padding: 15px 12px;
            border-radius: 10px;
            writing-mode: vertical-rl;
            text-orientation: upright;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            color: var(--primary-text);
            transition: background 0.2s;
        }

        .btn-mix:hover { background-color: #f9b88d; }

        .btn-reset {
            background-color: #fff;
            border: none;
            border-radius: 12px;
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.3s;
        }

        .btn-reset:hover { transform: rotate(-90deg); }

        /* çµæœå‹•æ…‹æ¨£å¼ */
        .res-title { font-weight: bold; font-size: 1.15rem; color: #724a23; margin-bottom: 8px; }
        .res-body { font-size: 0.9rem; line-height: 1.6; margin: 0; }
        .placeholder { color: #999; font-style: italic; }
    </style>
</head>
<body>

<div class="container">
    <h1>èª¿é…ä½ çš„å·§å…‹åŠ›</h1>
    <p class="subtitle">Part IVï¼šäº’å‹•å°éŠæˆ²</p>
    <hr>

    <div class="section-header">
        <div class="orange-bar"></div>
        <h2 class="section-title">é£Ÿæé¸æ“‡</h2>
    </div>

    <div class="ingredient-grid">
        <div class="ingredient-card" data-id="cocoa">
            <span class="icon">ğŸ«</span><p>å¯å¯</p>
        </div>
        <div class="ingredient-card" data-id="sugar">
            <span class="icon">ğŸ¬</span><p>ç³–</p>
        </div>
        <div class="ingredient-card" data-id="milk">
            <span class="icon">ğŸ¥›</span><p>ç‰›å¥¶</p>
        </div>
        <div class="ingredient-card" data-id="chili">
            <span class="icon">ğŸŒ¶ï¸</span><p>è¾£æ¤’</p>
        </div>
        <div class="ingredient-card" data-id="corn">
            <span class="icon">ğŸŒ½</span><p>ç‰ç±³ç²‰</p>
        </div>
        <div class="ingredient-card" data-id="cinnamon">
            <span class="icon">ğŸŒ¿</span><p>è‚‰æ¡‚</p>
        </div>
    </div>

    <div class="section-header">
        <div class="orange-bar"></div>
        <h2 class="section-title">å·§å…‹åŠ›æ”ªæ‹Œæ©Ÿ <small>ä½ çš„å‘³é“å±¬æ–¼å“ªå€‹æ™‚ä»£ï¼Ÿ</small></h2>
    </div>
    <p class="instruction">æ‹–æ›³ä¸Šæ–¹é£Ÿæåˆ°æ”ªæ‹Œæ©Ÿä¸­ï¼Œé»æ“Šæ··åˆï¼Œå¯åšå‡ºä¸åŒæ™‚ä»£çš„å·§å…‹åŠ›ã€‚</p>

    <div class="mixer-layout">
        <div class="display-area" id="screen">
            <p class="placeholder">ç­‰å¾…æ··åˆé£Ÿæ...</p>
        </div>
        <div class="controls">
            <button class="btn-mix" id="mixBtn">æ··åˆæ”ªæ‹Œ</button>
            <button class="btn-reset" id="resetBtn" title="å…¨éƒ¨é‡ç½®">â†»</button>
        </div>
    </div>
</div>

<audio id="pickSound" src="pick-92276.mp3" preload="auto"></audio>
<audio id="mixSound" src="videoplayback.mp3" preload="auto"></audio>
<audio id="resetSound" src="snowball-throw-hit_3-278173.mp3" preload="auto"></audio>

<script>
    const cards = document.querySelectorAll('.ingredient-card');
    const screen = document.getElementById('screen');
    const mixBtn = document.getElementById('mixBtn');
    const resetBtn = document.getElementById('resetBtn');

    // ç²å–éŸ³æ•ˆå…ƒç´ 
    const pickSound = document.getElementById('pickSound');
    const mixSound = document.getElementById('mixSound');
    const resetSound = document.getElementById('resetSound'); // æ–°å¢ï¼šé‡ç½®éŸ³æ•ˆ

    let selected = new Set();

    // æ’­æ”¾éŸ³æ•ˆçš„é€šç”¨å‡½æ•¸
    function playSound(audioElement) {
        audioElement.currentTime = 0;
        audioElement.play().catch(e => console.error("éŸ³æ•ˆæ’­æ”¾å¤±æ•—:", e));
    }

    // é»æ“Šé£Ÿæåˆ‡æ›é¸å–ç‹€æ…‹ (ä¸¦æ’­æ”¾é»æ“ŠéŸ³æ•ˆ)
    cards.forEach(card => {
        card.addEventListener('click', () => {
            const id = card.dataset.id;
            if (selected.has(id)) {
                selected.delete(id);
                card.classList.remove('active');
            } else {
                selected.add(id);
                card.classList.add('active');
            }
            playSound(pickSound); // æ’­æ”¾é»æ“ŠéŸ³æ•ˆ
        });
    });

    // æ··åˆæŒ‰éˆ•åŠŸèƒ½ (æ’­æ”¾æ··åˆéŸ³æ•ˆ)
    mixBtn.addEventListener('click', () => {
        playSound(mixSound); // æ’­æ”¾æ··åˆéŸ³æ•ˆ

        if (selected.size === 0) {
            screen.innerHTML = '<p style="color:#724a23;">è«‹å…ˆé¸æ“‡é£Ÿæï¼</p>';
            return;
        }

        const items = Array.from(selected);
        const has = (id) => items.includes(id);
        const count = items.length;

        let title = "";
        let desc = "";

        // åˆ¤æ–·é‚è¼¯
        if (count === 1 && has('cocoa')) {
            title = "ã€ç‘ªé›…æ–‡æ˜æ™‚æœŸã€‘";
            desc = "é€™è¢«ç¨±ç‚ºã€Œè«¸ç¥çš„é£Ÿç‰©ã€ã€‚åœ¨å¤ç‘ªé›…æ–‡æ˜ä¸­ï¼Œå¯å¯ä¸åªæ˜¯é£Ÿç‰©ï¼Œæ›´æ˜¯ç¥è–çš„ç¥­å“èˆ‡è²¨å¹£ã€‚";
        }
        else if (has('cocoa') && ( (count === 3 && has('corn') && has('chili')) || (count === 2 && has('chili')) )) {
            title = "ã€é˜¿èŒ²ç‰¹å…‹çš‡å®¶é…æ–¹ã€‘";
            desc = "é€™æ˜¯æˆ°å£«çš„è–é£²ï¼æ·»åŠ è¾£æ¤’å¸¶ä¾†çš„è¾›è¾£æ„Ÿèƒ½æŒ¯å¥®ç²¾ç¥ï¼Œæ˜¯é˜¿èŒ²ç‰¹å…‹äººå‡ºå¾å‰çš„å¿…å‚™èƒ½é‡é£²æ–™ã€‚";
        }
        else if (has('cocoa') && has('cinnamon') && ( (count === 3 && has('sugar')) || count === 2 )) {
            title = "ã€è¥¿ç­ç‰™åŒ–é…æ–¹ã€‘";
            desc = "å¤§èˆªæµ·æ™‚æœŸçš„æç¥é£²æ–™ã€‚è¥¿ç­ç‰™äººç‚ºäº†é©æ‡‰æ­æ´²å£å‘³ï¼Œå»æ‰äº†è¾£æ¤’ï¼Œæ”¹åŠ å…¥è‚‰æ¡‚èˆ‡ç³–ï¼Œæˆç‚ºå®®å»·è²´æ—çš„çå¯µã€‚";
        }
        else if (has('cocoa') && ( (count === 2 && (has('sugar') || has('milk'))) || (count === 3 && has('sugar') && has('milk')) )) {
            title = "ã€ç¾ä»£å·§å…‹åŠ›ã€‘";
            desc = "é€™æ˜¯æˆ‘å€‘æœ€ç†Ÿæ‚‰çš„é¢¨å‘³ã€‚å·¥æ¥­é©å‘½å¾Œï¼Œç‰›å¥¶èˆ‡å¤§é‡çš„ç³–è®“å·§å…‹åŠ›è®Šå¾—å¹³æ˜“è¿‘äººä¸”æ»‘é †ç”œç¾ã€‚";
        }
        else {
            title = "ã€å…¨æ–°çš„å·§å…‹åŠ›æ–¹æ¡ˆã€‘";
            desc = "é€™ç¨®é…æ–¹å²ç„¡å‰ä¾‹ï¼æ­å–œä½ é…å‡ºäº†æ­·å²ä¸Šæœªæ›¾è¨˜è¼‰çš„å‰µæ–°æ»‹å‘³ï¼Œä¹Ÿè¨±ä½ å°±æ˜¯ä¸‹ä¸€å€‹å·§å…‹åŠ›å¤§å¸«ã€‚";
        }

        screen.innerHTML = `<div class="res-title">${title}</div><p class="res-body">${desc}</p>`;

        // è¦–è¦ºåé¥‹
        screen.style.backgroundColor = "#fff";
        setTimeout(() => screen.style.backgroundColor = "var(--card-bg)", 200);
    });

    // é‡ç½®æŒ‰éˆ•åŠŸèƒ½ (æ’­æ”¾é‡ç½®éŸ³æ•ˆ)
    resetBtn.addEventListener('click', () => {
        playSound(resetSound); // æ’­æ”¾é‡ç½®éŸ³æ•ˆ

        selected.clear();
        cards.forEach(c => c.classList.remove('active'));
        screen.innerHTML = '<p class="placeholder">ç­‰å¾…æ··åˆé£Ÿæ...</p>';
    });
</script>

</body>
</html>